<page-header></page-header>

<title-bar
  title="{{ 'titles.manage' | translate }}"
  [management]="true">
</title-bar>

<div class="container-lg pb-5 mt-3">
  <p-toast></p-toast>

  <div class="buttons mt-2">
    <button type="button" class="btn btn-secondary rounded-0 w-100" [routerLink]="['/home']">{{ 'go-to.home-page' | translate }}</button>
  </div>

  <div class="events mt-3">
    <h2 class="fs-4">{{ 'manage.events' | translate }}</h2>
    <p-table styleClass="mt-3" #eventsTable
      [value]="events" dataKey="id" [rows]="5"
      [rowsPerPageOptions]="[5,10,25,50]" [loading]="isLoadingEvents"
      [paginator]="true" [globalFilterFields]="['name','location','startDate','endDate']">
      <ng-template pTemplate="caption">
        <input pInputText type="text" (input)="filterEventsTable($event)" placeholder="{{ 'manage.search' | translate }}" />
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th>{{ 'manage.event-form.name' | translate }}</th>
          <th>{{ 'manage.event-form.location' | translate }}</th>
          <th>{{ 'manage.event-form.date-start' | translate }}</th>
          <th>{{ 'manage.event-form.date-end' | translate }}</th>
          <th style="width:4rem"></th>
          <th style="width:4rem"></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-event>
        <tr>
          <td>{{ event.name }}</td>
          <td>{{ event.location }}</td>
          <td>{{ event.startDate | date:'dd/MM/yyyy' }}</td>
          <td>{{ event.endDate | date:'dd/MM/yyyy' }}</td>
          <td>
            <button type="button" pButton icon="pi pi-pencil" (click)="openEvent(event)" title="{{ 'manage.edit' | translate }}"></button>
          </td>
          <td>
            <button type="button" pButton icon="pi pi-trash" (click)="removeEvent(event)" title="{{ 'manage.delete' | translate }}" class="p-button-danger"></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6">{{ 'manage.no-results-found' | translate }}</td>
        </tr>
      </ng-template>
    </p-table>
    <div class="buttons mt-2 text-end">
      <button type="button" class="btn btn-success rounded-0" [routerLink]="['/event', 'new']">{{ 'manage.add-event' | translate }}</button>
    </div>
  </div>

  <div class="people mt-3">
    <h2 class="fs-4">{{ 'manage.people' | translate }}</h2>
    <p-table styleClass="mt-3" #peopleTable
      [value]="people" dataKey="id" [rows]="5"
      [rowsPerPageOptions]="[5,10,25,50]" [loading]="isLoadingPeople"
      [paginator]="true" [globalFilterFields]="['name','email','document','dateOfBirth']">
      <ng-template pTemplate="caption">
        <input pInputText type="text" (input)="filterPeopleTable($event)" placeholder="{{ 'manage.search' | translate }}" />
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th>{{ 'manage.person-form.name' | translate }}</th>
          <th>{{ 'manage.person-form.email' | translate }}</th>
          <th>{{ 'manage.person-form.document' | translate }}</th>
          <th>{{ 'manage.person-form.date-of-birth' | translate }}</th>
          <th style="width:4rem"></th>
          <th style="width:4rem"></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-person>
        <tr>
          <td>{{ person.name }}</td>
          <td>{{ person.email }}</td>
          <td>{{ person.document }}</td>
          <td>{{ person.dateOfBirth | date:'dd/MM/yyyy' }}</td>
          <td>
            <button type="button" pButton icon="pi pi-pencil" (click)="openPerson(person)" title="{{ 'manage.edit' | translate }}"></button>
          </td>
          <td>
            <button type="button" pButton icon="pi pi-trash" (click)="removePerson(person)" title="{{ 'manage.delete' | translate }}" class="p-button-danger"></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6">{{ 'manage.no-results-found' | translate }}</td>
        </tr>
      </ng-template>
    </p-table>
    <div class="buttons mt-2 text-end">
      <button type="button" class="btn btn-success rounded-0" [routerLink]="['/person', 'new']">{{ 'manage.add-person' | translate }}</button>
    </div>
  </div>
</div>

<p-confirmDialog icon="pi pi-exclamation-triangle"></p-confirmDialog>
